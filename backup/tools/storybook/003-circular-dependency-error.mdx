---
slug: circular-dependency-error
title: 'ìŠ¤í† ë¦¬ë¶ ì‘ì„± ì¤‘ ë°œìƒí•œ ìˆœí™˜ ì°¸ì¡° ì—ëŸ¬ í•´ê²°í•˜ê¸°: Dropdown ì»´í¬ë„ŒíŠ¸ ì‚¬ë¡€ ë¶„ì„'
image: './img/storybook_error_circular_dependency_error.webp'
tags: ['Frontend', 'TroubleShooting', 'Storybook']
sidebar_position: 3
sidebar_label: '003 ìŠ¤í† ë¦¬ ì‘ì„± ì¤‘ ìˆœí™˜ ì°¸ì¡° ì—ëŸ¬ í•´ê²°ê¸°'
keywords: ['Frontend', 'Storybook', 'Framework', 'TroubleShooting', 'ìˆœí™˜ì°¸ì¡°', 'ìˆœí™˜ì°¸ì¡° ë¬¸ì œ', 'ì—ëŸ¬', 'ë²„ê·¸', 'í•´ê²° ë°©ë²•', 'useContext']
last_update:
  date: 2024-11-17
  author: zen
---

## ğŸ¯ ì´ ë¬¸ì„œë¥¼ ì½ê³  ë‚œ í›„ì˜ ìƒíƒœ

- ìŠ¤í† ë¦¬ë¶ì˜ ì‹¤ì œ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì•Œì•˜ë‹¤.
- ìŠ¤í† ë¦¬ë¶ ì‘ì„±ì‹œ ë§ˆì£¼í•œ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë°©ë²•ì„ ì•Œì•˜ë‹¤. ë˜í•œ ì£¼ì˜ì‚¬í•­ê¹Œì§€ë„.
- ì½”ë“œë¥¼ ì§¤ ë•Œ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í•˜ëŠ” ì§€ ì•Œì•˜ë‹¤.

## ğŸ˜­ ìŠ¤í† ë¦¬ë¶ ì‚¬ìš© ì¤‘ ë§Œë‚œ ì—ëŸ¬

import storybook_error_circular_dependency_error from './img/storybook_error_circular_dependency_error.webp'

<figure>
  <img src={storybook_error_circular_dependency_error} alt='ìŠ¤í† ë¦¬ë¶ ì´ë¯¸ì§€'/>
  <figcaption>ìŠ¤í† ë¦¬ë¶ ì‚¬ìš© ì¤‘ ë§Œë‚œ ì—ëŸ¬</figcaption>
</figure>

ì•ì—ì„œ íƒêµ¬í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìŠ¤í† ë¦¬ë¥¼ ì‘ì„±í•˜ë‹¤ê°€ ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ ë§Œë‚˜ê²Œ ë˜ì—ˆë‹¤. <br/>

ë¬´ì—‡ì´ ë¬¸ì œì¼ê¹Œ ì‹¶ì–´ì„œ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì„ í•œ ë‚´ìš©ì„ ì •ë¦¬í•˜ê³ ì í•œë‹¤. <br/>

## ğŸ¤” ë°°ê²½

ë¬¸ì œë¥¼ íƒêµ¬í•˜ê¸°ì— ì•ì„œì„œ í•˜ë‚˜ì”© ë‚´ê°€ ë¬´ì—‡ì„ í•˜ë ¤ê³  í–ˆëŠ”ì§€ í’€ì–´ë‚˜ê°€ê³ ì í•œë‹¤. <br/>

```markdown title="dropdown ë””ë ‰í† ë¦¬ êµ¬ì¡°"
dropdown
â”œâ”€â”€ Dropdown.tsx
â”œâ”€â”€ DropdownItem.tsx
â”œâ”€â”€ DropdownMenu.tsx
â””â”€â”€ DropdownTrigger.tsx
```

ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œì˜ êµ¬ì¡°ëŠ” ìœ„ì™€ ê°™ë‹¤. ê·¸ë¦¬ê³  ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ì´ ì“°ì—¬ì¡Œë‹¤.<br/>

```tsx title="Dropdown.tsx"
import { createContext, ReactNode, useMemo, useState } from 'react';
import { DropdownTrigger } from '@/component/common/dropdown/DropdownTrigger.tsx';
import { DropdownItem } from '@/component/common/dropdown/DropdownItem.tsx';
import { DropdownMenu } from '@/component/common/dropdown/DropdownMenu.tsx';

interface IDropdownProps {
  children: ReactNode;
}

export interface IToggleContext {
  isOpen: boolean;
  toggle: () => void;
}

export const ToggleContext = createContext<IToggleContext>({
  isOpen: false,
  toggle: () => {},
});

export const Dropdown = (props: IDropdownProps) => {
  const [isOpen, setIsOpen] = useState(false);

  const toggle = () => setIsOpen(prevIsOpen => !prevIsOpen);

  const toggleContextValue = useMemo(() => ({ isOpen, toggle }), [isOpen]);

  return (
    <aside className="relative flex w-fit flex-col">
      <ToggleContext.Provider value={toggleContextValue}>{props.children}</ToggleContext.Provider>
    </aside>
  );
};

Dropdown.Trigger = DropdownTrigger;
Dropdown.Item = DropdownItem;
Dropdown.Menu = DropdownMenu;
```

```tsx title="DropdownTrigger.tsx"
import { ReactNode, useContext } from 'react';
import classNames from 'classnames';
import { ToggleContext } from '@/component/common/dropdown/Dropdown.tsx';

interface IDropdownTriggerProps {
  /** ë²„íŠ¼ ë‚´ë¶€ì— ë“¤ì–´ê°ˆ ì»¨í…ì¸  */
  children: ReactNode;
}

/**
 * ë“œë¡­ë‹¤ìš´ íŠ¸ë¦¬ê±° ì»´í¬ë„ŒíŠ¸
 * @remarks ë“œë¡­ë‹¤ìš´ íŠ¸ë¦¬ê±° ì»´í¬ë„ŒíŠ¸ì…ë‹ˆë‹¤.
 * @component
 * @param {IDropdownTriggerProps} props.children ë²„íŠ¼ ë‚´ë¶€ì— ë“¤ì–´ê°ˆ ì»¨í…ì¸ 
 * @return {React.FunctionComponent}
 * @example
 * <DropdownTrigger>
 *   <MdMenu className="h-6 w-6" />
 *   <span>ë©”ë‰´</span>
 * </DropdownTrigger>
 *
 */

export const DropdownTrigger = (props: IDropdownTriggerProps) => {
  const { toggle } = useContext(ToggleContext);

  const handleOnClick = () => {
    toggle();
  };

  return (
    <button
      type="button"
      className={classNames(
        'flex',
        'justify-center',
        'items-center',
        'bg-transparent',
        'w-fit',
        'h-fit',
      )}
      data-component="DropdownTrigger"
      onClick={handleOnClick}
    >
      {props.children}
    </button>
  );
};
```

```tsx title="DropdownMenu.tsx"
import { ReactNode, useContext, useRef, useEffect } from 'react';
import classNames from 'classnames';
import { ToggleContext } from '@/component/common/dropdown/Dropdown.tsx';

interface IDropdownMenuProps {
  children: ReactNode | ReactNode[];
}

export const DropdownMenu = (props: IDropdownMenuProps) => {
  const { isOpen, toggle } = useContext(ToggleContext);
  const ref = useRef<HTMLUListElement | null>(null);

  const handleOutSideClick = (event: MouseEvent) => {
    const { target } = event;

    if (!(target instanceof HTMLElement)) {
      return;
    }

    if (
      ref.current &&
      target &&
      !ref.current.contains(target) &&
      target.dataset.component !== 'DropdownTrigger'
    ) {
      toggle();
    }
  };

  useEffect(() => {
    document.addEventListener('click', handleOutSideClick);
    return () => {
      document.removeEventListener('click', handleOutSideClick);
    };
  }, []);

  return (
    isOpen && (
      <ul
        ref={ref}
        className={classNames(
          // ì¶”í›„ ì• ë‹ˆë©”ì´ì…˜ ì¡°ê±´ë¶€ ì ìš©ì„ ìœ„í•´ì„œ classNames ì‚¬ìš©
          'align-center',
          'animate-smoothAppear',
          'absolute',
          'right-0',
          'top-8',
          'z-10',
          'flex',
          'flex-col',
          'justify-center',
          'gap-2.5',
          'rounded-xl',
          'p-2.5',
          'shadow-2xl',
          'w-fit',
          'bg-white',
        )}
      >
        {props.children}
      </ul>
    )
  );
};
```

```tsx title="DropdownItem.tsx"
import { ReactNode } from 'react';

interface IDropdownItemProps {
  children: ReactNode;
  onClick?: React.MouseEventHandler<HTMLButtonElement>;
}

export const DropdownItem = (props: IDropdownItemProps) => {
  // undefinedëŠ” reactì—ì„œ ëœë”ë§ í•˜ì§€ ì•ŠìŒ
  return (
    <li className="px-3 py-1.5 text-base">
      <button
        type="button"
        className="flex w-full items-center justify-between whitespace-nowrap bg-transparent"
        onClick={props.onClick}
      >
        {props.children}
      </button>
    </li>
  );
};
```

ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì¢‹ì€ ì½”ë“œì¸ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ, ì¼ë‹¨ì€ ì´ë ‡ê²Œ ì‘ì„±ì„ í–ˆë‹¤. <br/>

ê·¸ë¦¬ê³  ë¬¸ì œëŠ” `DropdownTrigger`ì— ëŒ€í•œ ìŠ¤í† ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ê³¼ì •ì—ì„œ ë°œìƒí–ˆë‹¤. <br/>

```tsx title="DropdownTrigger.stories.tsx"
import type { Meta, StoryObj } from '@storybook/react';

import { DropdownTrigger } from '@/component/common/dropdown/DropdownTrigger.tsx';

const meta = {
  title: 'Component/Common/Dropdown',
  component: DropdownTrigger,
  parameters: {
    layout: 'centered',
  },
  tags: ['autodocs'],
  argTypes: {
    // backgroundColor: { control: 'color' },
  },
  args: {},
} satisfies Meta<typeof DropdownTrigger>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Default: Story = {
  args: {
    children: 'test',
  },
};
```

ì´ê²Œ ë‚´ê°€ ì‘ì„±í•œ `DropdownTrigger`ì— ëŒ€í•œ ìŠ¤í† ë¦¬ì´ë‹¤. <br/>

## ğŸ¤” ë¬¸ì œ ìƒí™©
ì´ë ‡ê²Œ í•˜ê³ ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒì„ í–ˆë‹¤. <br/>

<figure>
  <img src={storybook_error_circular_dependency_error} alt='ìŠ¤í† ë¦¬ë¶ ì´ë¯¸ì§€'/>
  <figcaption>ìŠ¤í† ë¦¬ë¶ ì‚¬ìš© ì¤‘ ë§Œë‚œ ì—ëŸ¬</figcaption>
</figure>

```markdown title='ì—ëŸ¬ ë©”ì‹œì§€'
Cannot access 'DropdownTrigger' before initialization
The component failed to render properly, likely due to a configuration issue in Storybook. Here are some common causes and how you can address them:

Missing Context/Providers: You can use decorators to supply specific contexts or providers, which are sometimes necessary for components to render correctly. For detailed instructions on using decorators, please visit the Decorators documentation.
Misconfigured Webpack or Vite: Verify that Storybook picks up all necessary settings for loaders, plugins, and other relevant parameters. You can find step-by-step guides for configuring Webpack or Vite with Storybook.
Missing Environment Variables: Your Storybook may require specific environment variables to function as intended. You can set up custom environment variables as outlined in the Environment Variables documentation.
ReferenceError: Cannot access 'DropdownTrigger' before initialization
    at http://localhost:6006/src/component/common/dropdown/Dropdown.tsx?t=1731852387546:47:20

```

## ğŸ§‘â€ğŸ’» ë¬¸ì œì— ëŒ€í•œ ì ‘ê·¼

ì—ëŸ¬ê°€ ë°œìƒí–ˆìœ¼ë©´ ì œì¼ ë¨¼ì € í•´ì•¼í•˜ëŠ” ê²ƒì€ ëª…í™•í•˜ë‹¤.<br/>

ë°”ë¡œ ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ì½ê³  ë¶„ì„í•˜ëŠ” ê²ƒ. ì´ë¥¼ ì½ê³  í•˜ë‚˜ì”© ë¶„ì„ì„ í•´ë³´ì•˜ë‹¤.<br/>

```markdown title='ì—ëŸ¬ ë©”ì‹œì§€'
Cannot access 'DropdownTrigger' before initialization
```

ì´ ë¶€ë¶„ì„ ë³´ë©´ `DropdownTrigger`ë¥¼ ì´ˆê¸°í™”í•˜ê¸° ì „ì— ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤ê³  í•œë‹¤. <br/>

```markdown title='ì—ëŸ¬ ë©”ì‹œì§€'
The component failed to render properly, likely due to a configuration issue in Storybook. Here are some common causes and how you can address them:

Missing Context/Providers: You can use decorators to supply specific contexts or providers, which are sometimes necessary for components to render correctly. For detailed instructions on using decorators, please visit the Decorators documentation.
Misconfigured Webpack or Vite: Verify that Storybook picks up all necessary settings for loaders, plugins, and other relevant parameters. You can find step-by-step guides for configuring Webpack or Vite with Storybook.
Missing Environment Variables: Your Storybook may require specific environment variables to function as intended. You can set up custom environment variables as outlined in the Environment Variables documentation.
ReferenceError: Cannot access 'DropdownTrigger' before initialization
    at http://localhost:6006/src/component/common/dropdown/Dropdown.tsx?t=1731852387546:47:20
```

ê·¸ë¦¬ê³  ì´ ë‚´ìš©ì„ ë²ˆì—­í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. <br/>

```markdown title='ì—ëŸ¬ ë©”ì‹œì§€'
ëˆ„ë½ëœ ì»¨í…ìŠ¤íŠ¸/í”„ë¡œë°”ì´ë”: ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì»¨í…ìŠ¤íŠ¸ë‚˜ ê³µê¸‰ìë¥¼ ì œê³µí•  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì˜¬ë°”ë¥´ê²Œ ë Œë”ë§í•˜ëŠ” ë° í•„ìš”í•œ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.
ë°ì½”ë ˆì´í„° ì‚¬ìš©ì— ëŒ€í•œ ìì„¸í•œ ì§€ì¹¨ì€ ë°ì½”ë ˆì´í„° ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.
ì˜ëª» êµ¬ì„±ëœ ì›¹íŒ© ë˜ëŠ” Vite: ìŠ¤í† ë¦¬ë¶ì´ ë¡œë”, í”ŒëŸ¬ê·¸ì¸ ë° ê¸°íƒ€ ê´€ë ¨ ë§¤ê°œë³€ìˆ˜ì— ëŒ€í•´ í•„ìš”í•œ ëª¨ë“  ì„¤ì •ì„ ì„ íƒí–ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
ìŠ¤í† ë¦¬ë¶ìœ¼ë¡œ Webpack ë˜ëŠ” Viteë¥¼ êµ¬ì„±í•˜ëŠ” ë‹¨ê³„ë³„ ê°€ì´ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ëˆ„ë½ëœ í™˜ê²½ ë³€ìˆ˜: ìŠ¤í† ë¦¬ë¶ì´ ì˜ë„í•œ ëŒ€ë¡œ ì‘ë™í•˜ë ¤ë©´ íŠ¹ì • í™˜ê²½ ë³€ìˆ˜ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í™˜ê²½ ë³€ìˆ˜ ë¬¸ì„œì— ì„¤ëª…ëœ ëŒ€ë¡œ ì‚¬ìš©ì ì§€ì • í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì°¸ì¡° ì˜¤ë¥˜: http://localhost:6006/src/component/common/dropdown/Dropdown.tsx?t=1731852387546:47:20 ì—ì„œ ì´ˆê¸°í™”í•˜ê¸° ì „ì— 'ë“œë¡­ë‹¤ìš´ íŠ¸ë¦¬ê±°'ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
```

ë²ˆì—­ì€ `deepL`ì„ ì‚¬ìš©í–ˆë‹¤. <br/>

ì¡°ê¸ˆ ë” ëœ¯ì–´ì„œ ì‚´í´ë³´ê¸°ë¡œ í–ˆë‹¤.<br/>

## ğŸ“ ë³¸ì§ˆì ì¸ ì ‘ê·¼

```markdown title='ì—ëŸ¬ ë©”ì‹œì§€'
Cannot access 'DropdownTrigger' before initialization
```

ì‹œì‘ì€ ì´ ë©”ì„¸ì§€ë¥¼ ì´í•´í•˜ëŠ” ê²ƒë¶€í„° ì˜€ë‹¤.<br/>

ê´€ë ¨í•´ì„œ ì°¾ì•„ë³´ë‹ˆ ì´ ì—ëŸ¬ëŠ” `Javascript` ëª¨ë“ˆ ì‹œìŠ¤í…œì—ì„œ `í˜¸ì´ìŠ¤íŒ…(hosting)`ê³¼ `ìˆœí™˜ ì°¸ì¡°(circular dependencies)` ë¬¸ì œë¡œ ì¸í•´ ë°œìƒí•œë‹¤ê³  í•œë‹¤.<br/>

ë©”ì„¸ì§€ ê·¸ëŒ€ë¡œ, `DropdownTrigger`ë¥¼ ì´ˆê¸°í™”í•˜ê¸° ì „ì— ì ‘ê·¼í•˜ë ¤ê³  í•´ì„œ ë°œìƒí•œ ë¬¸ì œë¼ëŠ” ê²ƒì´ë‹¤.<br/>

## ğŸ“ í˜¸ì´ìŠ¤íŒ…ê³¼ ìˆœí™˜ ì°¸ì¡°ë€?

`í˜¸ì´ìŠ¤íŒ…(hoisting)`ì€ ê³¼ê±°ì— í–ˆì—ˆë˜ ìŠ¤í„°ë””ì—ì„œ ì¹œêµ¬ê°€ ì •ë¦¬í•œ ê¸€ì´ ìˆì–´ì„œ ì²¨ë¶€í•œë‹¤. <br/>

[ë ‰ì‹œì»¬ í™˜ê²½ê³¼ í˜¸ì´ìŠ¤íŒ…](https://refactor-js.vercel.app/javascript%20basic/chapter2/2-2)

`ìˆœí™˜ ì°¸ì¡°(circular dependencies)`ëŠ” ë‘ ê°œ ì´ìƒì˜ ëª¨ë“ˆì´ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ëŠ” ìƒí™©ì„ ë§í•œë‹¤. <br/>

ì´ëŸ° ìƒí™©ì—ì„œëŠ” ëª¨ë“ˆì´ ì´ˆê¸°í™”ë˜ê¸° ì „ì— ë‹¤ë¥¸ ëª¨ë“ˆì„ ì°¸ì¡°í•˜ë ¤ê³  í•˜ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ë°œìƒí•œë‹¤. <br/>

ì´ì™€ ê´€ë ¨ëœ ìì„¸í•œ ë‚´ìš©ì€ ì•„ë˜ë¥¼ ì°¸ê³ í•˜ì. <br/>

[ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œ](/dev-lab/frontEnd/troubleShooting/circular-dependencies)

<br/>

## ğŸ“ì›ì¸ ë¶„ì„

ì›ì´ˆë¶€í„° `Dropdown` ì»´í¬ë„ŒíŠ¸ ê´€ë ¨ ì½”ë“œì—ì„œ ë¬¸ì œê°€ ìˆì—ˆë‹¤.<br/>

### ğŸ”„ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œ
- `DropdownTrigger.tsx` íŒŒì¼ì—ì„œ `ToggleContext`ë¥¼ `Dropdown.tsx`ë¡œë¶€í„° ì„í¬íŠ¸í•˜ê³  ìˆë‹¤.
- ë°˜ëŒ€ë¡œ, `Dropdown.tsx` íŒŒì¼ ë‚´ì—ì„œ `DropdownTrigger`ë¥¼ ì„í¬íŠ¸í•˜ê³  ìˆë‹¤.
- ì´ ê²½ìš°, ë‘ íŒŒì¼ì´ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ê²Œ ë˜ì–´ ìˆœí™˜ ì°¸ì¡°ê°€ ë°œìƒí–ˆë‹¤. JavaScript ëª¨ë“ˆ ì‹œìŠ¤í…œì€ ì´ëŸ¬í•œ ìˆœí™˜ ì°¸ì¡°ë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•´ ì´ˆê¸°í™” ì „ì— ì ‘ê·¼í•˜ë ¤ëŠ” ì‹œë„ê°€ ë°œìƒí•˜ì˜€ê¸°ì— ìœ„ì™€ ê°™ì€ ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼°ë‹¤.

<br/>

ë˜í•œ, `eventHandler` ê´€ë ¨í•´ì„œë„ `mocking`ì´ í•„ìš”í•œ ì´ìŠˆê°€ ìˆì—ˆë‹¤.<br/>

### ğŸ“ ì»¨í…ìŠ¤íŠ¸ ì œê³µ ë¬¸ì œ
- `DropdownTrigger` ì»´í¬ë„ŒíŠ¸ëŠ” `ToggleContext`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤. Storybookì—ì„œ ì´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•  ë•Œ `ToggleContext`ë¥¼ ì œê³µí•˜ì§€ ì•Šìœ¼ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ì œëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ ìˆ˜ ìˆì—ˆë‹¤.

í•˜ì§€ë§Œ í˜„ì¬ ì—ëŸ¬ëŠ” ì£¼ë¡œ ìˆœí™˜ ì°¸ì¡°ë¡œ ì¸í•œ ì´ˆê¸°í™” ë¬¸ì œì´ë¯€ë¡œ, ìš°ì„ ì ìœ¼ë¡œ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ í•´ê²°í•˜ë©´ ë  ê²ƒ ê°™ì•˜ë‹¤.<br/>

## ğŸ¤” ì²˜ìŒì˜ ì˜ë„

ì²˜ìŒ ìœ„ ì½”ë“œë¥¼ ì§¤ ë•Œ, ë‚˜ëŠ” `Dropdown` ì»´í¬ë„ŒíŠ¸ë¥¼ ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ë‘ê³ , `DropdownTrigger`, `DropdownItem`, `DropdownMenu` ì»´í¬ë„ŒíŠ¸ë¥¼ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë¡œ ë‘ê³  ì‹¶ì—ˆë‹¤. <br/>

ê·¸ë¦¬ê³ , `Context` ì™€ ê°™ì€ ê²½ìš°ë„ ì•„ì£¼ ë‹¨ìˆœí•œ ìƒê°ìœ¼ë¡œ `Dropdown` ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•˜ë©´ ë˜ê² ë‹¤ê³  ìƒê°í–ˆë‹¤. <br/>

í•˜ì§€ë§Œ, ì´ëŸ¬í•œ ìƒê°ì´ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ ë°œìƒì‹œí‚¤ëŠ” ì›ì¸ì´ ë˜ì—ˆë‹¤. <br/>

## ğŸ“ í•´ê²° ë°©ë²•

í•´ê²° ë°©ë²•ì€ ì•„ì£¼ ë‹¨ìˆœí–ˆë‹¤. ê·¸ëƒ¥ `useContext` ë•Œë¬¸ì— ì´ë¥¼ ë³„ë„ì˜ ëª¨ë“ˆë¡œ ë¶„ë¦¬ì‹œí‚¤ê¸°ë§Œ í•˜ë©´ ë˜ì—ˆë‹¤.<br/>

```tsx title="DropdownContext.tsx"
import { createContext, ReactNode, useMemo, useState } from 'react';

export interface IToggleContext {
  isOpen: boolean;
  toggle: () => void;
}

interface IToggleProviderProps {
  children: ReactNode;
}

export const ToggleContext = createContext<IToggleContext>({
  isOpen: false,
  toggle: () => {},
});

export const ToggleProvider = (props: IToggleProviderProps) => {
  const [isOpen, setIsOpen] = useState(false);
  const toggle = () => setIsOpen(prevIsOpen => !prevIsOpen);
  const toggleContextValue = useMemo(() => ({ isOpen, toggle }), [isOpen]);

  return (
    <ToggleContext.Provider value={toggleContextValue}>{props.children}</ToggleContext.Provider>
  );
};
```

ìœ„ì™€ ê°™ì´ `context`ë¥¼ ë³„ë„ì˜ ëª¨ë“ˆë¡œ ë¶„ë¦¬ì‹œì¼°ë‹¤.<br/>

```tsx title="Dropdown.tsx"
import { ReactNode } from 'react';
import { DropdownTrigger } from '@/component/common/dropdown/DropdownTrigger.tsx';
import { DropdownItem } from '@/component/common/dropdown/DropdownItem.tsx';
import { DropdownMenu } from '@/component/common/dropdown/DropdownMenu.tsx';
import { ToggleProvider } from '@/component/common/dropdown/DropdownContext.tsx';

interface IDropdownProps {
  children: ReactNode;
}

export const Dropdown = (props: IDropdownProps) => {
  return (
    <aside className="relative flex w-fit flex-col">
      <ToggleProvider>{props.children}</ToggleProvider>
    </aside>
  );
};

Dropdown.Trigger = DropdownTrigger;
Dropdown.Item = DropdownItem;
Dropdown.Menu = DropdownMenu;
```

ê·¸ë¦¬ê³  `Dropdown` ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” `ToggleProvider`ë¡œ ê°ì‹¸ì£¼ê²Œ ìˆ˜ì •í•˜ì˜€ë‹¤.<br/>

```tsx title="DropdownTrigger.tsx"
import { ReactNode, useContext } from 'react';
import classNames from 'classnames';
import { ToggleContext } from '@/component/common/dropdown/DropdownContext';

interface IDropdownTriggerProps {
  /** ë²„íŠ¼ ë‚´ë¶€ì— ë“¤ì–´ê°ˆ ì»¨í…ì¸  */
  children: ReactNode;
}

export const DropdownTrigger = (props: IDropdownTriggerProps) => {
  const { toggle } = useContext(ToggleContext);

  const handleOnClick = () => {
    toggle();
  };

  return (
    <button
      type="button"
      className={classNames(
        'flex',
        'justify-center',
        'items-center',
        'bg-transparent',
        'w-fit',
        'h-fit',
      )}
      data-component="DropdownTrigger"
      onClick={handleOnClick}
    >
      {props.children}
    </button>
  );
};
```

`DropdownTrigger` ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” `ToggleContext`ë¥¼ `DropdownContext`ë¡œë¶€í„° ì„í¬íŠ¸í•˜ê²Œ ìˆ˜ì •í•˜ì˜€ë‹¤.<br/>

ì´ë ‡ê²Œ í•˜ë©´ ìˆœí™˜ ì°¸ì¡° ë¬¸ì œê°€ í•´ê²°ë˜ê³ , `Context`ë¥¼ ì œê³µí•˜ëŠ” ë¬¸ì œë„ í•´ê²°ë˜ì—ˆë‹¤. <br/>

ë˜í•œ ìŠ¤í† ë¦¬ë„ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. <br/>

import storybook_error_circular_dependency_solved from './img/storybook_error_circular_dependency_solved.webp'

<figure>
  <img src={storybook_error_circular_dependency_solved} alt='ìŠ¤í† ë¦¬ë¶ ì´ë¯¸ì§€'/>
  <figcaption>ì—ëŸ¬ê°€ í•´ê²°ëœ ëª¨ìŠµ</figcaption>
</figure>

## ğŸ“ ë²ˆì™¸ : ìŠ¤í† ë¦¬ë¶ì—ì„œ Context ì œê³µí•˜ê¸°

`DropdownTrigger`ë¥¼ ìŠ¤í† ë¦¬ë¶ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ `ToggleProvider`ë¥¼ ë°ì½”ë ˆì´í„°ë¡œ ì¶”ê°€í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•´ì•¼ í•œë‹¤.<br/>

ì´ì— ëŒ€í•´ì„œëŠ” ì•„ë˜ì— ì •ë¦¬í•´ë‘ì—ˆìœ¼ë‹ˆ ì°¸ê³ í•˜ì.<br/>

[ìŠ¤í† ë¦¬ë¶ì—ì„œ useContext ì‚¬ìš©í•˜ê¸°](/dev-lab/frontEnd/tools/storybook/how-to-use-useContext-on-storybook)

## ğŸ“š ì •ë¦¬

- ìˆœí™˜ ì°¸ì¡° ë¬¸ì œëŠ” JavaScript ëª¨ë“ˆ ì‹œìŠ¤í…œì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œì´ë‹¤.
- ìˆœí™˜ ì°¸ì¡° ë¬¸ì œëŠ” ëª¨ë“ˆì´ ì´ˆê¸°í™”ë˜ê¸° ì „ì— ë‹¤ë¥¸ ëª¨ë“ˆì„ ì°¸ì¡°í•˜ë ¤ëŠ” ì‹œë„ë¡œ ì¸í•´ ë°œìƒí•œë‹¤.
- ìˆœí™˜ ì°¸ì¡° ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ëª¨ë“ˆì„ ì¬êµ¬ì„±í•˜ê±°ë‚˜, í•„ìš”í•œ ê²½ìš° ëª¨ë“ˆì„ ë¶„ë¦¬í•˜ì—¬ ìˆœí™˜ ì°¸ì¡°ë¥¼ ë°©ì§€í•´ì•¼ í•œë‹¤.
- ìŠ¤í† ë¦¬ë¶ì—ì„œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ë ¤ë©´ ë°ì½”ë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•´ì•¼ í•œë‹¤.

